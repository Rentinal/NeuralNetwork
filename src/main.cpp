// main.cpp : This file contains the 'main' function. Program execution begins and ends there.
#include "nnfspch.h"
#include "denseLayer.hpp"
#include "activationFunctions/activationSoftmax.hpp"
#include "activationFunctions/activationReLU.hpp"
#include "activationFunctions/activationSMLossCC.hpp"
#include "lossFunctions/categoricalLossEntropy.hpp"
#include "lossFunctions/accuracy.hpp"
#include "optimizers/stochasticGradientDescent.hpp"
#include "optimizers/adaptiveGradient.hpp"
#include "optimizers/rootMeanSquareProp.hpp"
#include "optimizers/adaptiveMomentum.hpp"


int main()
{
  constexpr int32_t SAMPLE_AMOUNT = 100;
  constexpr int32_t CLASS_COUNT = 3;

  const dMatrix A = { { 0.19609152, 0.2706099 }, { -0.08493352, 0.59626206 }, { -0.31665033, 0.41865859 }, { -0.00281167, 0.47756092 }, { -0.00281167, 0.47756092 }, { -0.00281167, 0.47756092 }, { -0.01311485, 0.52054818 }, { 0.04684007, 0.46404129 }, { -0.02632755, 0.61669852 }, { 0.1610121, 0.2756311 }, { 0.00939703, 0.54066149 }, { 0.18520739, 0.577633 }, { 0.04877577, 0.50342336 }, { -0.0614463, 0.58990558 }, { 0.13477048, 0.44822741 }, { 0.22330533, 0.51146965 }, { 0.09483885, 0.34184554 }, { 0.10343698, 0.46929307 }, { 0.05780596, 0.53042686 }, { -0.10669233, 0.49351559 }, { 0.04668051, 0.59693169 }, { 0.04097596, 0.51328019 }, { -0.02684167, 0.56110597 }, { -0.08843209, 0.64048981 }, { -0.04323557, 0.57983385 }, { 0.24368345, 0.36861818 }, { 0.06634238, 0.453642 }, { -0.03589724, 0.43250726 }, { -0.14057948, 0.55856489 }, { 0.016928, 0.46948623 }, { -0.10792879, 0.49614202 }, { -0.0666273, 0.61830879 }, { -0.06834934, 0.48265371 }, { 0.01691102, 0.54964319 }, { 0.01696311, 0.57155627 }, { -0.06561787, 0.45411584 }, { -0.21418571, 0.33140885 }, { 0.12036369, 0.60904154 }, { -0.07862842, 0.45219074 }, { -0.10293584, 0.68012074 }, { 0.08260476, 0.62429265 }, { 0.06818977, 0.54807907 }, { 0.00581456, 0.41503249 }, { -0.03431729, 0.42565001 }, { -0.14658193, 0.42790609 }, { 0.03585709, 0.39125319 }, { -0.03736093, 0.48272721 }, { -0.05946638, 0.42180616 }, { 0.03714862, 0.29056871 }, { -0.11994547, 0.39179722 }, { 0.07742518, 0.62987574 }, { -0.06250114, 0.46028189 }, { 0.01585938, 0.47796654 }, { -0.04712089, 0.506315 }, { 0.03320536, 0.5783659 }, { -0.16319887, 0.61361772 }, { -0.06074411, 0.39778737 }, { 0.00460639, 0.40123961 }, { 0.00337327, 0.32045364 }, { 0.03330408, 0.57227139 }, { -0.17571176, 0.50059847 }, { 0.03773615, 0.17782058 }, { 0.05715724, 0.52182063 }, { -0.11887162, 0.46127936 }, { 0.05445734, 0.29784131 }, { -0.0686223, 0.44828056 }, { 0.26034587, 0.53209298 }, { -0.02078494, 0.48112864 }, { -0.12994035, 0.68436696 }, { 0.06927031, 0.5195017 }, { 0.16121193, 0.52031841 }, { 0.00924677, 0.41504962 }, { 0.15727553, 0.34811186 }, { -0.07819323, 0.57668553 }, { -0.02696788, 0.55035364 }, { -0.20201452, 0.40646615 }, { 0.24799857, 0.57153588 }, { -0.06839439, 0.49197696 }, { -0.09458113, 0.59053455 }, { 0.06080554, 0.6245806 }, { -0.08819973, 0.51620354 }, { -0.14602146, 0.29926981 }, { -0.02608782, 0.37970316 }, { -0.07375175, 0.45724657 }, { 0.14517741, 0.57326268 }, { -0.31447939, 0.61610647 }, { 0.09008648, 0.57515605 }, { 0.06146965, 0.4550026 }, { 0.00712698, 0.36684703 }, { -0.03868149, 0.58330424 }, { 0.01133867, 0.53173358 }, { 0.05882942, 0.43581418 }, { -0.0980855, 0.59484289 }, { -0.05905528, 0.42582899 }, { -0.10085828, 0.47623382 }, { -0.00322929, 0.62131966 }, { -0.02924666, 0.66518256 }, { 0.07466937, 0.39252525 }, { 0.11944295, 0.48166627 }, { -0.24206172, 0.56867963 }, { -0.00337424, 0.61093698 }, { 0.00244039, 0.55131214 }, { 0.39787197, 0.51242468 }, { 0.41237873, 0.50645369 }, { 0.24673709, 0.48224747 }, { 0.24451439, 0.55099668 }, { 0.25043442, 0.51756324 }, { 0.51689412, 0.50729287 }, { 0.46684632, 0.44157088 }, { 0.12095523, 0.48470142 }, { 0.2162149, 0.6498838 }, { 0.38608206, 0.63446425 }, { 0.3107443, 0.50976046 }, { 0.32789828, 0.31253437 }, { 0.27825452, 0.5019728 }, { 0.35628493, 0.49534867 }, { 0.23623774, 0.51075518 }, { 0.46735204, 0.23935061 }, { 0.4125843, 0.53106033 }, { 0.44879842, 0.44705144 }, { 0.30613579, 0.53873118 }, { 0.3212069, 0.62479955 }, { 0.49844166, 0.7003804 }, { 0.28640685, 0.59199069 }, { 0.4841904, 0.53315337 }, { 0.45633844, 0.43912755 }, { 0.48686389, 0.35760424 }, { 0.33993303, 0.40633287 }, { 0.31477831, 0.38092088 }, { 0.43552561, 0.61651518 }, { 0.51476569, 0.49524933 }, { 0.47209031, 0.66858759 }, { 0.31680301, 0.460293 }, { 0.37547871, 0.32016571 }, { 0.19177128, 0.63686901 }, { 0.37448496, 0.54275588 }, { 0.33456281, 0.63187046 }, { 0.16848928, 0.57223483 }, { 0.12298345, 0.29509299 }, { 0.29505352, 0.26466834 }, { 0.34821614, 0.4900622 }, { 0.38542681, 0.50139326 }, { 0.42236697, 0.53794738 }, { 0.32428628, 0.40718482 }, { 0.3391862, 0.625623 }, { 0.42879678, 0.36977051 }, { 0.4455782, 0.41098781 }, { 0.30544877, 0.61578829 }, { 0.42248388, 0.57267837 }, { 0.27118968, 0.30183603 }, { 0.29731803, 0.53508087 }, { 0.22861377, 0.63796115 }, { 0.07030859, 0.58396585 }, { 0.33084142, 0.26749413 }, { 0.40393974, 0.55842052 }, { 0.29193278, 0.5011716 }, { 0.42795695, 0.47091394 }, { 0.26002086, 0.69134401 }, { 0.2634729, 0.36669931 }, { 0.3926102, 0.43053256 }, { 0.39698002, 0.59764358 }, { 0.54869585, 0.60316649 }, { 0.28081245, 0.28761487 }, { 0.3885185, 0.5967209 }, { 0.25971558, 0.43921021 }, { 0.51404644, 0.47884335 }, { 0.28217013, 0.63871567 }, { 0.34744137, 0.64964536 }, { 0.35800131, 0.53782662 }, { 0.25357671, 0.61649138 }, { 0.30478621, 0.60533295 }, { 0.46260839, 0.50698469 }, { 0.4027598, 0.48907864 }, { 0.37191421, 0.46910991 }, { 0.37222508, 0.56974551 }, { 0.40483179, 0.53736127 }, { 0.4001344, 0.45061481 }, { 0.21706221, 0.52518564 }, { 0.36259204, 0.52431254 }, { 0.35401416, 0.54310472 }, { 0.42071001, 0.3822947 }, { 0.33869184, 0.45337016 }, { 0.25691346, 0.65429804 }, { 0.26653971, 0.45118598 }, { 0.30949984, 0.46585463 }, { 0.52438432, 0.43486774 }, { 0.24973654, 0.5104667 }, { 0.52628155, 0.23218958 }, { 0.30981631, 0.61404857 }, { 0.23057902, 0.51428785 }, { 0.4693369, 0.46478102 }, { 0.32578758, 0.24015517 }, { 0.28820024, 0.5159689 }, { 0.47458914, 0.52968748 }, { 0.17628691, 0.58556742 }, { 0.33144393, 0.57841187 }, { 0.36697668, 0.60347544 }, { 0.46727477, 0.46767202 }, { 0.29939578, 0.41544564 }, { 0.37550134, 0.39655873 }, { 0.27788958, 0.58122714 }, { 0.47144582, 0.3547434 }, { 0.64701764, 0.53670954 }, { 0.63224731, 0.39357098 }, { 0.72795566, 0.45335339 }, { 0.69213231, 0.35112093 }, { 0.45241064, 0.52526431 }, { 0.70241666, 0.3948726 }, { 0.67614679, 0.5573803 }, { 0.69438436, 0.75968703 }, { 0.65937489, 0.55771194 }, { 0.61194398, 0.48504649 }, { 0.64796598, 0.49261077 }, { 0.55301769, 0.45688155 }, { 0.47808776, 0.48085051 }, { 0.85739666, 0.40486269 }, { 0.70392413, 0.58087592 }, { 0.66387445, 0.6092325 }, { 0.76047991, 0.46074818 }, { 0.6521018, 0.60243604 }, { 0.91387865, 0.5470264 }, { 0.48828151, 0.37981757 }, { 0.71700757, 0.5203261 }, { 0.74044329, 0.52200415 }, { 0.63308351, 0.60546572 }, { 0.59308821, 0.69975616 }, { 0.71896724, 0.49854344 }, { 0.63619418, 0.67948138 }, { 0.72823801, 0.47499203 }, { 0.68661614, 0.55014797 }, { 0.66626487, 0.38443824 }, { 0.84437685, 0.56833079 }, { 0.61863152, 0.33767998 }, { 0.6836659, 0.44622546 }, { 0.67868014, 0.56220629 }, { 0.90042306, 0.43876057 }, { 0.62792621, 0.57848587 }, { 0.52736968, 0.5026136 }, { 0.46536769, 0.52665659 }, { 0.58336694, 0.43620482 }, { 0.78604534, 0.38186347 }, { 0.51671411, 0.5544266 }, { 0.72122065, 0.50911164 }, { 0.85685882, 0.67918382 }, { 0.76360882, 0.50560193 }, { 0.49321066, 0.31836218 }, { 0.7913676, 0.46679963 }, { 0.68045448, 0.23245475 }, { 0.68719925, 0.43151928 }, { 0.62984586, 0.55872607 }, { 0.59785444, 0.60414889 }, { 0.65965183, 0.59082989 }, { 0.77631425, 0.37795134 }, { 0.66290708, 0.59141075 }, { 0.53386622, 0.57058821 }, { 0.67976026, 0.55364638 }, { 0.61199391, 0.48447926 }, { 0.80738937, 0.44957982 }, { 0.7595846, 0.4987296 }, { 0.74266471, 0.76828978 }, { 0.80268707, 0.43252135 }, { 0.59876148, 0.43548096 }, { 0.68294233, 0.47834681 }, { 0.47429232, 0.62109451 }, { 0.74001722, 0.51365173 }, { 0.67637554, 0.48172511 }, { 0.54638892, 0.57126832 }, { 0.73012248, 0.55349536 }, { 0.63621945, 0.3584775 }, { 0.47732447, 0.55820634 }, { 0.77133402, 0.43698175 }, { 0.60500279, 0.34626568 }, { 0.73031946, 0.41211971 }, { 0.62754022, 0.56343234 }, { 0.68280799, 0.55505436 }, { 0.49548393, 0.34953112 }, { 0.45028607, 0.43497529 }, { 0.63628185, 0.41138804 }, { 0.69180177, 0.53622669 }, { 0.86005657, 0.47097404 }, { 0.79912548, 0.54465286 }, { 0.62846079, 0.48522116 }, { 0.63867469, 0.31524829 }, { 0.67641415, 0.43843896 }, { 0.59221188, 0.58153831 }, { 0.56506857, 0.57856467 }, { 0.75827092, 0.30290255 }, { 0.5969319, 0.51666776 }, { 0.69969481, 0.42452164 }, { 0.7768301, 0.57966552 }, { 0.77653661, 0.30571552 }, { 0.79381842, 0.61362818 }, { 0.45887965, 0.28638414 }, { 0.69689493, 0.49506033 }, { 0.53095129, 0.48292918 }, { 0.6222192, 0.3790832 }, { 0.60960668, 0.48160518 }, { 0.58028783, 0.5199218 }, { 0.68096674, 0.3557747 }, { 0.71857115, 0.43377169 } };
  const dMatrix B = { { -0.00000000e+00, 0.00000000e+00 }, { 5.36533785e-03, 8.55824484e-03 }, { 5.14090172e-03, 1.95369586e-02 }, { -3.24318066e-04, 3.03012947e-02 }, { 1.35436951e-02, 3.80664525e-02 }, { 4.65257280e-02, 1.96498540e-02 }, { 3.14646651e-02, 5.17983535e-02 }, { 6.92134456e-02, 1.44564449e-02 }, { 1.76103802e-02, 7.88658382e-02 }, { 8.69473222e-02, 2.65447917e-02 }, { 7.18205934e-02, 7.10270573e-02 }, { 1.06667625e-01, 3.11078255e-02 }, { 1.09798895e-01, 5.13476493e-02 }, { 1.24375226e-01, 4.21181865e-02 }, { 1.40517115e-01, 1.59028212e-02 }, { 1.50453635e-01, 1.79037638e-02 }, { 1.04753546e-01, 1.23071030e-01 }, { 1.67779737e-01, 3.65615508e-02 }, { 1.73483815e-01, -5.44170654e-02 }, { 1.91898207e-01, -2.83802309e-03 }, { 1.94904395e-01, -5.31454505e-02 }, { 1.74156287e-01, -1.21099117e-01 }, { 1.19162237e-01, -1.87571526e-01 }, { 1.88436068e-01, -1.35889413e-01 }, { 4.60284050e-02, -2.38014494e-01 }, { 2.39760312e-01, -7.92716602e-02 }, { -4.87508108e-02, -2.58061838e-01 }, { 1.51806029e-01, -2.26572494e-01 }, { 5.75919151e-02, -2.76902526e-01 }, { 4.68009552e-02, -2.89166459e-01 }, { 1.54545487e-01, -2.60658890e-01 }, { 1.58825899e-01, -2.69862100e-01 }, { -3.10669683e-01, -8.92383498e-02 }, { -1.53551326e-01, -2.95859935e-01 }, { 4.16062911e-02, -3.40904774e-01 }, { -2.67678271e-01, -2.30944992e-01 }, { -5.92679941e-02, -3.58773898e-01 }, { -1.40615861e-01, -3.46275619e-01 }, { -2.33374665e-01, -3.04742794e-01 }, { -2.20649623e-01, -3.26346426e-01 }, { -8.68416567e-02, -3.94597484e-01 }, { -3.94276108e-01, -1.26725931e-01 }, { -4.09083570e-01, -1.12393360e-01 }, { -4.14758411e-01, 1.28956114e-01 }, { -4.41838374e-01, -4.80595002e-02 }, { -4.51431488e-01, 5.31147981e-02 }, { -4.48636773e-01, -1.20918910e-01 }, { -2.72905981e-01, 3.88468133e-01 }, { -3.71835394e-01, 3.11153488e-01 }, { -4.49566792e-01, 2.07037924e-01 }, { -2.56986737e-01, 4.34780209e-01 }, { -4.27512822e-01, 2.87426287e-01 }, { -4.75012387e-01, 2.24172807e-01 }, { -4.80774800e-01, 2.35497344e-01 }, { -4.41829365e-01, 3.19855394e-01 }, { -2.99596265e-01, 4.67850461e-01 }, { -2.00910327e-01, 5.28774424e-01 }, { -1.20863165e-01, 5.62928842e-01 }, { -1.70863772e-01, 5.60389020e-01 }, { -8.41967587e-02, 5.89981988e-01 }, { 2.95249887e-02, 6.05341006e-01 }, { 2.93642420e-01, 5.41691117e-01 }, { -6.02063312e-01, -1.72408370e-01 }, { 1.57663523e-02, 6.36168295e-01 }, { 2.98017988e-01, 5.73673965e-01 }, { 3.16079880e-01, 5.75475430e-01 }, { 2.40203593e-01, 6.21889603e-01 }, { 5.67252176e-01, 3.69106294e-01 }, { 5.23973020e-01, 4.44118078e-01 }, { 6.19854293e-01, 3.18665050e-01 }, { 6.89420056e-01, 1.56999906e-01 }, { 2.06118404e-01, 6.86913732e-01 }, { 6.76797626e-01, 2.66215314e-01 }, { 4.80686495e-01, 5.59160551e-01 }, { 7.07380981e-01, -2.41517383e-01 }, { 7.53535251e-01, 7.81386878e-02 }, { 7.61785197e-01, 9.49259361e-02 }, { 7.20534691e-01, -2.92861795e-01 }, { 7.44713572e-01, 2.57205520e-01 }, { 7.56498798e-01, 2.53931735e-01 }, { 7.24256327e-01, -3.58395543e-01 }, { 8.09072728e-01, -1.21748953e-01 }, { 3.64483716e-01, 7.43776892e-01 }, { 8.32049153e-01, 1.02867235e-01 }, { 6.04320643e-01, -5.95586348e-01 }, { 7.54815466e-01, -4.09173910e-01 }, { 3.67082298e-01, -7.87316621e-01 }, { 7.85172260e-01, -3.94680451e-01 }, { 8.80977494e-01, 1.18330517e-01 }, { 6.30063257e-01, -6.41251223e-01 }, { 9.19833935e-02, -9.04425418e-01 }, { 7.98661076e-01, -4.55032163e-01 }, { 2.21456693e-01, -9.02519962e-01 }, { 4.70127556e-03, -9.39382175e-01 }, { -3.70504898e-01, -8.74223530e-01 }, { -3.67575165e-01, -8.86404481e-01 }, { -5.45817716e-01, -8.01495623e-01 }, { 2.30016150e-01, -9.52416218e-01 }, { -9.80752988e-01, 1.34251955e-01 }, { 1.39514113e-02, -9.99902674e-01 }, { -0.00000000e+00, -0.00000000e+00 }, { -5.50960523e-03, -8.46608855e-03 }, { -1.29273611e-02, -1.55243343e-02 }, { -7.60645434e-03, -2.93328399e-02 }, { -4.03367273e-02, 2.33129051e-03 }, { -3.00372002e-02, -4.06020533e-02 }, { -5.99608534e-02, -8.81990040e-03 }, { -3.53021614e-02, -6.12637515e-02 }, { -8.08025491e-02, 9.45504697e-04 }, { -9.08853091e-02, 2.07927890e-03 }, { -9.48929120e-02, 3.46175643e-02 }, { -9.06327508e-02, 6.42758391e-02 }, { -1.21132128e-01, -4.40293187e-03 }, { -1.29156380e-01, -2.37016433e-02 }, { -1.37265017e-01, -3.40040354e-02 }, { -1.16991197e-01, 9.62803250e-02 }, { -4.71151565e-02, 1.54596073e-01 }, { -1.39764757e-01, 9.97627174e-02 }, { -1.84919074e-02, 1.80875373e-01 }, { -8.72856376e-02, 1.70921601e-01 }, { -1.00755793e-02, 2.01768790e-01 }, { -1.84032228e-01, 1.05487192e-01 }, { -1.56278310e-01, 1.57986727e-01 }, { -9.42494649e-02, 2.12346704e-01 }, { -6.84065215e-02, 2.32572701e-01 }, { -6.31891137e-02, 2.44491593e-01 }, { 9.09282109e-02, 2.46383064e-01 }, { 6.25859335e-02, 2.65448990e-01 }, { 2.14913930e-01, 1.83858207e-01 }, { 1.40523699e-01, 2.57022685e-01 }, { 2.75997450e-01, 1.25111039e-01 }, { 1.85088867e-01, 2.52573416e-01 }, { 2.99369487e-01, 1.21889478e-01 }, { 2.61561035e-01, 2.06632370e-01 }, { 2.78491443e-01, -2.00971801e-01 }, { 1.34296300e-01, 3.27034784e-01 }, { 1.95107569e-01, 3.06862252e-01 }, { 3.48132737e-01, 1.35953014e-01 }, { 2.96851372e-01, -2.43333450e-01 }, { 3.85484201e-01, -8.11799022e-02 }, { 3.65097206e-01, 1.73068421e-01 }, { 3.77440357e-01, 1.70446143e-01 }, { 3.70266377e-01, 2.07085598e-01 }, { 2.89349108e-01, -3.23931031e-01 }, { 2.70367098e-01, -3.52749906e-01 }, { 4.42010698e-01, -1.06009966e-01 }, { 7.29154411e-03, -4.64589249e-01 }, { 1.66649107e-01, -4.44537108e-01 }, { 4.12319253e-01, -2.55089958e-01 }, { 4.54425388e-01, -1.96144256e-01 }, { 3.67618068e-01, -3.46313396e-01 }, { 3.13628858e-01, -4.08678386e-01 }, { 1.99320345e-01, -4.85964624e-01 }, { 1.13692662e-01, -5.23141842e-01 }, { -1.39405943e-01, -5.27339212e-01 }, { 2.23817641e-01, -5.08475800e-01 }, { -8.68075807e-02, -5.58955986e-01 }, { -1.58044614e-01, -5.53641297e-01 }, { -3.30779957e-01, -4.83544106e-01 }, { 1.77828256e-02, -5.95694226e-01 }, { -4.09749483e-01, -4.46558864e-01 }, { -1.78716156e-01, -5.89674209e-01 }, { -2.61461483e-01, -5.69071849e-01 }, { -6.22379755e-01, -1.32672977e-01 }, { -4.29814570e-01, -4.82882982e-01 }, { -6.50061779e-01, 9.21853862e-02 }, { -5.39444571e-01, 3.91719286e-01 }, { -6.17815817e-01, 2.76257316e-01 }, { -6.81049794e-01, -8.92175471e-02 }, { -6.96097274e-01, -3.48617708e-02 }, { -7.03023565e-01, 7.55437111e-02 }, { -3.69729758e-01, -6.14520283e-01 }, { -4.52585350e-01, -5.69290893e-01 }, { -7.36716098e-01, -3.11354950e-02 }, { -7.42996236e-01, 8.17012359e-02 }, { -4.68621892e-01, -5.95243270e-01 }, { -7.67422341e-01, -1.97628496e-02 }, { -5.16223848e-01, 5.81765598e-01 }, { -7.72764420e-01, 1.53584293e-01 }, { -6.93949952e-01, -3.93960940e-01 }, { -7.73313052e-01, 2.34481376e-01 }, { -4.69103687e-01, 6.70345597e-01 }, { -3.79269372e-01, 7.36347192e-01 }, { 3.55890787e-02, 8.37628126e-01 }, { -1.37262080e-01, 8.37308581e-01 }, { -2.37127138e-01, 8.25191127e-01 }, { -3.94174944e-01, 7.74107867e-01 }, { 2.50716964e-01, 8.42264293e-01 }, { -6.22937839e-01, 6.34091402e-01 }, { 8.22967455e-02, 8.95215105e-01 }, { -2.72293493e-02, 9.08683027e-01 }, { 4.77243646e-01, 7.85590407e-01 }, { -4.87830640e-01, 7.90952979e-01 }, { -4.03837968e-02, 9.38525504e-01 }, { 2.47486780e-01, 9.16673853e-01 }, { 5.49203554e-01, 7.86892535e-01 }, { 9.42279953e-01, 2.28955681e-01 }, { 9.02390430e-01, 3.81700920e-01 }, { 5.76784255e-01, 8.04499803e-01 }, { 9.06732987e-01, 4.21705218e-01 }, { 0.00000000e+00, 0.00000000e+00 }, { 6.71136432e-03, 7.54903928e-03 }, { 2.01973979e-02, 4.32132971e-04 }, { 3.02372124e-02, 1.99615481e-03 }, { 3.12237872e-02, -2.56429638e-02 }, { 4.12532976e-02, 2.91363272e-02 }, { 3.98694220e-02, -4.56456326e-02 }, { 6.84921836e-02, -1.75587766e-02 }, { 7.94767282e-02, -1.46080662e-02 }, { 7.21531412e-02, -5.53026855e-02 }, { 1.00988817e-01, -2.07348745e-03 }, { -1.10216544e-03, -1.11105645e-01 }, { 7.89360937e-02, -9.19862568e-02 }, { 8.75357853e-02, -9.78806659e-02 }, { -5.11450709e-02, -1.31841348e-01 }, { 8.90558693e-02, -1.22580150e-01 }, { 1.12188089e-01, -1.16334073e-01 }, { 2.97031199e-02, -1.69128684e-01 }, { -4.00158110e-02, -1.77360047e-01 }, { 5.89994855e-02, -1.82625401e-01 }, { -6.03877468e-02, -1.92783511e-01 }, { -7.49275518e-02, -1.98447148e-01 }, { -8.79608759e-02, -2.04072537e-01 }, { -1.81479204e-01, -1.45049588e-01 }, { 6.60324240e-02, -2.33257867e-01 }, { -2.20087693e-01, -1.23816036e-01 }, { -2.31360638e-01, -1.24277146e-01 }, { -1.44717493e-01, -2.31164470e-01 }, { -2.53206426e-01, 1.26009299e-01 }, { -2.06174882e-01, -2.08085292e-01 }, { -2.38895680e-01, -1.86430198e-01 }, { -3.12499040e-01, 1.98889186e-02 }, { -2.89560280e-01, -1.43645324e-01 }, { -2.54599793e-01, -2.15151241e-01 }, { -2.92539317e-01, -1.79910801e-01 }, { -3.33294919e-01, -1.17905653e-01 }, { -3.14327351e-01, -1.82837965e-01 }, { -3.64075165e-01, -8.44328045e-02 }, { -3.49573930e-01, -1.58524359e-01 }, { -3.13833149e-01, 2.38111320e-01 }, { -3.54184362e-01, 1.94427584e-01 }, { -2.44593762e-01, 3.34196054e-01 }, { -4.22078724e-01, 4.27923524e-02 }, { -1.32728410e-01, 4.13566667e-01 }, { -4.35930623e-01, 8.65757239e-02 }, { 2.58585125e-01, 3.73825231e-01 }, { -2.34923958e-01, 4.00882865e-01 }, { -4.73959856e-01, -2.73353164e-02 }, { 1.76101353e-01, 4.51737055e-01 }, { 6.65805192e-02, 4.90450851e-01 }, { -7.65306291e-02, 4.99218465e-01 }, { 4.70090592e-01, 2.10703391e-01 }, { 1.93767518e-01, 4.88205248e-01 }, { 1.80757349e-01, 5.03914863e-01 }, { 2.17587147e-01, 5.00176464e-01 }, { 2.81700036e-01, 4.78839289e-01 }, { 3.59643298e-01, 4.36605140e-01 }, { 1.00884841e-01, 5.66850099e-01 }, { 2.63065147e-01, 5.23475893e-01 }, { 3.88621900e-01, -4.51819498e-01 }, { 5.29433731e-01, 2.94973529e-01 }, { -2.32311094e-02, 6.15723520e-01 }, { 6.05906136e-01, 1.58374971e-01 }, { 5.43907008e-01, 3.30338984e-01 }, { 6.28315245e-01, -1.52106846e-01 }, { 5.75333695e-01, 3.16337796e-01 }, { 6.66653030e-01, -4.26409070e-03 }, { 6.76511104e-01, -1.86336994e-02 }, { 6.60890340e-01, -1.87116412e-01 }, { 6.37439862e-01, 2.81846024e-01 }, { 7.03528292e-01, -7.06889481e-02 }, { 7.15795225e-01, -4.44124697e-02 }, { 5.63204329e-01, -4.60137483e-01 }, { 4.52359854e-01, -5.82314856e-01 }, { 7.05403591e-01, -2.47233235e-01 }, { 4.17042092e-01, -6.32453099e-01 }, { 2.21981358e-01, -7.34882233e-01 }, { 3.32402785e-01, -7.03169013e-01 }, { 1.85284880e-01, -7.65782278e-01 }, { 5.71079651e-01, -5.57350688e-01 }, { 6.55399432e-02, -8.05418592e-01 }, { 3.05810771e-01, -7.58881585e-01 }, { 2.07614670e-01, -8.01840753e-01 }, { 5.68919481e-01, -6.15806856e-01 }, { 1.15147157e-01, -8.40635278e-01 }, { -4.72588043e-01, -7.16819516e-01 }, { 1.39225188e-01, -8.57457417e-01 }, { -2.66512283e-01, -8.37400346e-01 }, { -2.66354118e-01, -8.48044185e-01 }, { -6.79180343e-01, -5.88979542e-01 }, { -4.16851862e-01, -8.07886630e-01 }, { -7.65871206e-01, -5.08286415e-01 }, { -8.77589553e-01, -3.05650004e-01 }, { -4.93801864e-01, -7.99137468e-01 }, { -8.28027930e-01, -4.64661604e-01 }, { -8.87743156e-01, -3.64330201e-01 }, { -9.08545653e-01, 3.38905606e-01 }, { -8.09796340e-01, -5.51574083e-01 }, { -2.15748025e-01, 9.66101858e-01 }, { -8.47658784e-01, 5.30541786e-01 } };

  auto [X, y] = utils::spiral_data(SAMPLE_AMOUNT, CLASS_COUNT);

  denseLayer dense1(2, 64);

  activationReLU act1;

  denseLayer dense2(64, 3);

  activationSMLossCC lossActivation;

  //stochasticGradientDescent optimizer(1.0, 1e-3, 0.9);
  //adaptiveGradient optimizer(1.0, 1e-3, 1e-5);
  //rootMeanSquareProp optimizer(0.02, 1e-5, 1e-7, 0.999);
  adaptiveMomentum optimizer(0.05, 5e-7);

  for (size_t i = 0; i < 10001; i++) {
    dense1.forward(B);

    act1.forward(dense1.output());

    dense2.forward(act1.output());

    double loss = lossActivation.forward(dense2.output(), y);
    accuracy accuracy;
    accuracy.calculate(lossActivation.output(), y);

    if (!(i % 100)) {
      std::cout << "Epoch: " << i << ", ";
      std::cout << "Acc: " << accuracy.output() << ", ";
      std::cout << "Loss: " << loss << ", ";
      std::cout << "LR: " << optimizer.currentLearningRate() << '\n';
    }

    lossActivation.backward(lossActivation.output(), y);
    dense2.backward(lossActivation.dInput());
    act1.backward(dense2.dInput());
    dense1.backward(act1.dInput());

    optimizer.preUpdateParams();
    optimizer.updateParams(dense1);
    optimizer.updateParams(dense2);
    optimizer.postUpdateParams();
  }
}
